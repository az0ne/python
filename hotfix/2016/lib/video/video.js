/*! LPS4.0 2016-09-14
*/
function isEnd(){1==video.ended&&($(document).trigger("mouseup"),video.currentTime=0,isFullScreen()&&exitFullScreen(),controlBar.detach(),$(".videoStopMeg").show())}function showBigPlayButton(){"True"!=$("#ad").val()||"True"==$("#is_paid").val()||0==video.currentTime?$(".vip").show():$(".ordinary").show()}function pop_pay(){oJustPay=$("#just_pay"),oJustPay.hasClass("in")||oJustPay.modal({show:!0,keyboard:!1,backdrop:"static"})}function startPause(){video.paused?(video.play(),$(".loading-video").hide(),$(".big-play-button").hide(),0==$(".control-bar").length&&zvideoWrap.append(controlBar),$(".videoStopMeg").hide(),controlText.text("Pause").attr("title","Pause").removeClass("playing").addClass("paused"),zvideoWrap.mousemove(function(){controlBar.fadeIn(500),isFullScreen()&&videoHeader.fadeIn(500)}),$(window).moveStopEvent(function(){controlBar.fadeOut(500),isFullScreen()&&videoHeader.fadeOut(500)})):(video.pause(),showBigPlayButton(),controlText.text("Play").attr("title","Play").removeClass("paused").addClass("playing"),Ad.show())}function updateVolume(){var e,t,i,s,a;e=arguments[0]?arguments[0]:null,t=arguments[1]?arguments[1]:null,i=$(".volume-level"),s=i.height(),a=video.volume*s,e?a=s-(e-i.offset().top):t&&(a+=s*t);var o=a/s;o>1&&(o=1),0>o&&(o=0),a=s*o,video.muted&&toggleMute(),video.volume=o,volumeHandle.css("height",a+"px")}function toggleMute(){switch(video.muted=!video.muted,Volume.toggleClass("mute"),video.muted){case!0:volumeHandle.css("height","0");break;case!1:volumeHandle.css("height",$(".volume-level").height()*video.volume)}return!1}function setTime(e){0==e?video.currentTime=e:video.currentTime+=e}function isFullScreen(){var e,t,i,s,a;return e=document,t=e.fullscreenElement,i=e.mozFullScreenElement,s=e.webkitFullscreenElement,a=e.msFullscreenElement,t||i||s||a}function toggleFullScreen(){isFullScreen()?exitFullScreen():fullScreen()}function fullScreen(){_isFull=!0,zvideoWrap.css({width:"100%",height:"100%"}),zvideo.requestFullscreen?zvideo.requestFullscreen():zvideo.webkitRequestFullscreen?zvideo.webkitRequestFullscreen():zvideo.mozRequestFullScreen?zvideo.mozRequestFullScreen():zvideo.msRequestFullscreen&&zvideo.msRequestFullscreen(),$(".full-screen").addClass("quit-screen"),videoWrap.after(videoHeaderDom),$(".view-port .Big").addClass("on").siblings().removeClass("on")}function exitFullScreen(){_isFull=!1;var e=document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.oRequestFullscreen?e.oCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen(),videoHeader.detach(),videoWrap.width("100%").height("100%").css({margin:0}),$(".full-screen").removeClass("quit-screen")}function changeTime(e){var t,i,s;return t=Math.floor(e/3600),i=Math.floor(e/60),s=Math.floor(e%60),s=10>s?"0"+s:s,i=10>i?"0"+i:i,t=10>t?"0"+t:t,(t>0?t+":":"")+i+":"+s}function update(){var e,t,i;e=video.currentTime,t=video.duration,i=e/t,$(".timeBar").css("width",100*i+"%"),$(".timeBar span").css("margin-right",20*(i-1));var s=$(".video-header");!isFullScreen()&&s.length?(videoHeader.detach(),_isFull=!1,videoWrap.width("100%").css({margin:"0"}).height("100%")):isFullScreen()&&!s.length&&(videoWrap.after(videoHeaderDom),_isFull=!0),isEnd()}function updatebar(e){var t,i,s,a;t=$(".progressBar"),i=video.duration,t.length>0?(s=e-t.offset().left,a=100*s/t.width()):a=100,a>100&&(a=100),0>a&&(a=0),$(".timeBar").css("width",a+"%"),$(".timeBar span").css("margin-right",20*(a/100-1)),0==video.ended&&(video.currentTime=i*a/100)}var volumeDrag,inVolumeControl,VolumeControl,_isFull,videoHeaderDom,timeDrag,OFF1=!0,zvideoWrap=$(".zvideo"),zvideo=zvideoWrap[0],videoWrap=$("video"),video=videoWrap[0],controlText=$(".play-control .control-text"),controlBar=$(".control-bar"),videoHeader=$(".video-header"),Volume=$(".volume"),volumeControl=$(".volume-control"),volumeHandle=$(".volume-handle"),outFull=$(".out-full a"),Ad=$(".ad"),fullWidth="1024px",fullHeight="768px",headTitle1=$(".video_part_lists li.liH a").find(".col_l").text(),headTitle2=$(".zyleve1 li.liH a").attr("title");controlBar.mousemove(function(e){var e=e||event;e.stopPropagation()}),videoHeader.mousemove(function(e){var e=e||event;e.stopPropagation()}),$(".loading-video, .play-control").on("click",function(){var e=$("ul.video_part_lists li").index($("ul.video_part_lists li.liH"))+1;"False"==$thisUser?login_popup("请先登录"):(1==OFF1&&($studentClass.length>0?(videoWrap.attr("src",$vipUrl),videoWrap.load()):1==e||2==e?(videoWrap.attr("src",$lessonUrl),videoWrap.load()):(""!=$isPaid||"True"!=$needPay)&&(videoWrap.attr("src",$lessonUrl),videoWrap.load())),OFF1=!1)}),$("video, .big-play-button, .loading-video, .play-control").on("click",function(){var e=$("ul.video_part_lists li").index($("ul.video_part_lists li.liH"))+1;"True"==$thisUser&&1==e||2==e?startPause():""==$isPaid&&"True"==$needPay?pop_pay():startPause()}),Ad.on("click",function(e){var e=e||event;e.stopPropagation()}),$(".ad span").on("click",function(){$(this).parent().hide()}),$(document).keyup(function(e){e=e||window.event;var t=e.which||e.keyCode;32==t&&(startPause(),zvideoWrap.mousemove())}),volumeDrag=!1,inVolumeControl=!1,VolumeControl=$(".volume, .volume-control"),VolumeControl.mouseenter(function(){inVolumeControl=!0,volumeControl.show()}),VolumeControl.mouseleave(function(){inVolumeControl=!1,volumeDrag||volumeControl.hide()}),$(".volume-handle,.volume-level").mousedown(function(e){volumeDrag=!0,volumeControl.show(),updateVolume(e.pageY)}),$(document).mouseup(function(e){volumeDrag&&(volumeDrag=!1,updateVolume(e.pageY),inVolumeControl||volumeControl.hide())}),$(document).mousemove(function(e){volumeDrag&&updateVolume(e.pageY)}),$(document).keyup(function(e){e=e||window.event;var t=e.which||e.keyCode;38==t&&updateVolume(null,.1)}),$(document).keyup(function(e){e=e||window.event;var t=e.which||e.keyCode;40==t&&updateVolume(null,-.1)}),$(".volume span").click(function(){toggleMute()}),$(document).keyup(function(e){e=e||window.event;var t=e.which||e.keyCode;39==t&&setTime(10)}),$(document).keyup(function(e){e=e||window.event;var t=e.which||e.keyCode;37==t&&setTime(-10)}),$(".view-port a").click(function(){var e,t;e=$(this).text().split("%")[0]/100,$(this).addClass("on").siblings().removeClass("on"),fullWidth=$(window).innerWidth(),fullHeight=$(window).innerHeight(),t=(1-e)/2*fullHeight+"px "+(1-e)/2*fullWidth+"px",videoWrap.width(fullWidth*e).height(fullHeight*e).css({margin:t})}),function(e){e.fn.moveStopEvent=function(t){return this.each(function(){var i,s=0,a=0,o=0,n=0,l=!1,r=this,c=function(){i=setInterval(function(){video.paused?clearInterval(i):(s==o&&a==n&&(clearInterval(i),l=!1,t&&t.call(r)),s=o,a=n)},1e3)};e(this).mousemove(function(e){o=e.pageX,n=e.pageY,!l&&c(),l=!0}).mouseout(function(){clearInterval(i),l=!1})})}}(jQuery),_isFull=!1,videoHeader.find(".video-name").text(headTitle1||headTitle2),videoHeaderDom=videoHeader.show().detach(),$(".full-screen").on("click",function(){toggleFullScreen()}),$(document).keyup(function(e){e=e||window.event;var t=e.which||e.keyCode;27==t&&(exitFullScreen(),zvideoWrap.mousemove())}),outFull.on("click",function(){exitFullScreen()}),$(".duration").text(changeTime($videoLength)),videoWrap.on("timeupdate",function(){$(".current").text(changeTime(video.currentTime))}),window.setInterval(function(){update()},250),video.addEventListener("progress",function(){if(4==video.readyState){var e=100*(video.buffered.end(0)/video.duration);$(".bufferBar").css("width",e+"%")}},!1),timeDrag=!1,$(".progressBar").mousedown(function(e){timeDrag=!0,updatebar(e.pageX)}),$(document).mouseup(function(e){timeDrag&&(timeDrag=!1,updatebar(e.pageX))}),$(document).mousemove(function(e){timeDrag&&updatebar(e.pageX)}),$(".play-rate-menu ul li").click(function(){var e=$(this).text().split("x")[0];$(this).addClass("on").siblings().removeClass("on"),video.playbackRate=e,$(this).parents(".play-rate-menu").siblings("span").text(e+"x")});