/*! LPS4.0 2016-11-04
*/
function personalInfoSelect(){function e(){$(".resume .births").val($("#year1").val()+"-"+$("#month2").val()+"-"+$("#day3").val())}var t=birthtime||"1970-01-01";new GySetDate({targets:"#year1,#month2,#day3",range:"1970-01-01,"+nowtimeselect,value:t}),e(),$(".resume .birSelect select").change(e);for(var s=nowtimes.getFullYear(),r="",a=$(".resume .info #workDate"),i=0;30>=i;i++)r=s-i==worktime?"<option value="+(s-i)+" selected=true>"+(s-i)+"年</option>":"<option value="+(s-i)+">"+(s-i)+"年</option>",a.append(r);r="<option value=0>请选择</option>",a.append(r),0==worktime&&a.val("0")}function experSelect(){function e(){$(".resume #experStartTime").val($("#experStartTimeYear").val()+"-"+$("#experStartTimeMonth").val())}function t(){$(this).parent().siblings(".error").text(""),$(".resume #experEndTime").val($("#experEndTimeYear").val()+"-"+$("#experEndTimeMonth").val())}var s=experStartTime||"1990-01-01";new GySetDate({targets:"#experStartTimeYear,#experStartTimeMonth,#experStartTimeDay",range:"1990-01-01,"+nowtimeselect,value:s});var r=experEndTime||"1990-01-03";new GySetDate({targets:"#experEndTimeYear,#experEndTimeMonth,#experEndTimeDay",range:"1990-01-01,"+nowtimeselect,value:r}),e(),t(),$(".resume .exper .starttime select").change(e),$(".resume .exper .endtime select").change(t)}function educSelect(){function e(){$(".resume #educStartTime").val($("#educStartTimeYear").val()+"-"+$("#educStartTimeMonth").val())}function t(){$(this).parent().siblings(".error").text(""),$(".resume #educEndTime").val($("#educEndTimeYear").val()+"-"+$("#educEndTimeMonth").val())}var s=educStartTime||"1990-01-01";new GySetDate({targets:"#educStartTimeYear,#educStartTimeMonth,#educStartTimeDay",range:"1990-01-01,"+nowtimeselect,value:s});var r=educEndTime||"1990-01-03";new GySetDate({targets:"#educEndTimeYear,#educEndTimeMonth,#educEndTimeDay",range:"1990-01-01,"+nowtimeselect,value:r}),e(),t(),$(".resume .educ .starttime select").change(e),$(".resume .educ .endtime select").change(t)}function save_work_success(e){var t,s,r,a,i,n,l,d;t=$(".resume .exper"),s=$(".resume .exper .experList"),r=t.find("#company").val(),a=t.find("#worlPast").val(),i=t.find("#experStartTime").val(),n=t.find("#experEndTime").val(),l=t.find("#jobDesc").val(),d="",d+='<li id="'+e+'">',d+='<div class="boxTop">',d+='	<span class="title"><span class="exper_start_time">'+i+'</span>—<span class="exper_end_time">'+n+'</span> | <span class="exper_company">'+r+"</span></span>",d+='<span class="handle"><em class="del">删除</em><em class="edit">编辑</em></span>',d+="</div>",d+='<div class="boxCon">',d+='<p><strong>工作岗位：</strong><span class="exper_work_title">'+a+"</span></p>",d+='<p><strong>工作描述：</strong><span class="exper_work_content">'+l+"</span></p>",d+="</div>",d+="</li>",is_click_experedit?s.find("#"+e).replaceWith(d):s.append(d),_exper_create_block=!1,$(".resume .exper .create").remove(),$(".resume .exper #"+experliId).children(".create").remove(),$(".resume .exper #"+experliId).children().fadeIn(300),$(".resume .exper .add").fadeIn(300)}function save_educ_success(e){var t,s,r,a,i,n,l,d;t=$(".resume .educ"),s=$(".resume .educ .experList"),r=t.find("#school").val(),a=t.find("#major").val(),i=t.find("#educStartTime").val(),n=t.find("#educEndTime").val(),l=t.find("#education").val(),d="",d+='<li id="'+e+'">',d+='<div class="boxTop">',d+='	<span class="title"><span class="educ_start_time">'+i+'</span> — <span class="educ_end_time">'+n+'</span> | <span class="educ_school">'+r+"</span></span>",d+='<span class="handle"><em class="del">删除</em><em class="edit">编辑</em></span>',d+="</div>",d+='<div class="boxCon">',d+='<span><em>专业名称：</em><span class="educ_major">'+a+"</span></span>",d+='<span><em>学历：</em><span class="educ_title">'+l+"</span></span>",d+="</div>",d+="</li>",is_click_educedit?s.find("#"+e).replaceWith(d):s.append(d),_educ_create_block=!1,$(".resume .educ .create").remove(),$(".resume .educ #"+educliId).children(".create").remove(),$(".resume .educ #"+educliId).children().fadeIn(300),$(".resume .educ .add").fadeIn(300)}function clearExperVal(){var e=$(".resume .exper");e.find("#company").val(""),e.find("#worlPast").val(""),e.find("#experStartTime").val(""),e.find("#experEndTime").val(""),e.find("#jobDesc").val("")}function cleareducVal(){var e=$(".resume .educ");e.find("#school").val(""),e.find("#major").val(""),e.find("#educStartTime").val(""),e.find("#educEndTime").val("")}function exper_val_legal(){$(".resume").on({keyup:function(){var e=$(this).val();e.length>50?$(this).siblings(".error").text("字数不超过50个"):0==e.length?$(this).siblings(".error").text("请输入公司名称"):$(this).siblings(".error").text("")}},"#company"),$(".resume").on({keyup:function(){$(this).val().length>50?$(this).siblings(".error").text("字数不超过50个"):0==$(this).val().length?$(this).siblings(".error").text("请输入工作岗位"):$(this).siblings(".error").text("")}},"#worlPast"),$(".resume").on({keyup:function(){var e=$(this).val();e.length>500?$(this).siblings(".error").text("字数不超过500个"):0==e.length?$(this).siblings(".error").text("请输入工作描述"):$(this).siblings(".error").text("")}},"#jobDesc")}function educ_val_legal(){$(".resume").on({keyup:function(){$(this).val().length>50?$(this).siblings(".error").text("字数不超过50个"):0==$(this).val().length?$(this).siblings(".error").text("请输入学校名称"):$(this).siblings(".error").text("")}},"#school"),$(".resume").on({keyup:function(){$(this).val().length>50?$(this).siblings(".error").text("字数不超过50个"):0==$(this).val().length?$(this).siblings(".error").text("请输入专业名称"):$(this).siblings(".error").text("")}},"#major")}function exper_worktime_endval(){var e=$(".resume .exper .nowtime");"至今"==experEndTime?(e.addClass("active"),$(".resume .exper .endtime select").attr("disabled","disabled").css("background","#f4f3f3"),$(".resume #experEndTime").val("至今")):(e.removeClass("active"),$(".resume .exper .endtime select").removeAttr("disabled").css("background","#fff"))}function educ_readtime_endval(){var e=$(".resume .educ .nowtime");"至今"==educEndTime?(e.addClass("active"),$(".resume .educ .endtime select").attr("disabled","disabled").css("background","#f4f3f3"),$(".resume #educEndTime").val("至今")):(e.removeClass("active"),$(".resume .educ .endtime select").removeAttr("disabled").css("background","#fff"))}function exper_worktime_endvalnowtime(){var e=$(".resume .exper");e.on({click:function(){$(this).siblings(".error").text(""),$(this).hasClass("active")?($(this).removeClass("active"),$(".resume .exper .endtime select").removeAttr("disabled").css("background","#fff"),$(".resume #experEndTime").val($(".resume #experEndTimeYear").val()+"-"+$(".resume #experEndTimeMonth").val())):($(this).addClass("active"),$(".resume .exper .endtime select").attr("disabled","disabled").css("background","#f4f3f3"),$(".resume #experEndTime").val("至今"))}},".nowtime")}function educ_readtime_endvalnowtime(){var e=$(".resume .educ");e.on({click:function(){$(this).siblings(".error").text(""),$(this).hasClass("active")?($(this).removeClass("active"),$(".resume .educ .endtime select").removeAttr("disabled").css("background","#fff"),$(".resume #educEndTime").val($(".resume #educEndTimeYear").val()+"-"+$(".resume #educEndTimeMonth").val())):($(this).addClass("active"),$(".resume .educ .endtime select").attr("disabled","disabled").css("background","#f4f3f3"),$(".resume #educEndTime").val("至今"))}},".nowtime")}var nowtimes,nowtimeselect,is_click_experedit=!1,is_click_educedit=!1,experliId,educliId;nowtimes=new Date,nowtimeselect=nowtimes.getFullYear()+"-"+(nowtimes.getMonth()+1)+"-"+nowtimes.getDate();var init=function(){$(".personalCTop .font .personalCico").hover(function(){layer.tips($(this).attr("title"),$(this),{tips:[1,"#333333"]})},function(){}),$(".resume .tabTit li").on("click",function(){$(this).addClass("cur").siblings().removeClass("cur"),$(".resume .tabBox>div").eq($(this).index()).addClass("cur").siblings().removeClass("cur")}),$(".resume .radio-inline").on("click",function(){$(this).addClass("active").siblings().removeClass("active")}),personalInfoSelect();var e=$(".resume .info .username"),t=$(".resume .info #workDate");e.on("keyup",function(){e.val().length>0?(e.removeClass("err"),e.siblings(".error").text("")):(e.addClass("err"),e.siblings(".error").text("请输入您的姓名"))}),t.change(function(){$(this).siblings(".error").text("")}),$(".resume .info .submitBtn input").on("click",function(){var s=$(".resume .info .save-tips");return 0==e.val().length?(e.siblings(".error").text("请输入您的姓名"),void 0):"0"==t.val()?(t.siblings(".error").text("请选择开始工作时间"),void 0):($.ajax({type:"POST",url:"/home/s/ajax_save_resume_user_info/",data:$("#resumeForm").serialize(),dataType:"json",success:function(e){e.success?(s.removeClass("err").addClass("succ").text("保存成功").fadeIn(200),setTimeout(function(){s.removeClass("succ").text("").fadeOut(200)},5e3),$(".personalTab").find("em").remove()):(s.removeClass("succ").addClass("err").text("保存失败").fadeIn(200),setTimeout(function(){s.removeClass("err").text("").fadeOut(200)},5e3))}}),void 0)});var s='<div class="create">	<form id="workExperForm">		<input type="hidden" id="workLastInsert" value="">		<div class="form-group">			<label for="company" class="control-label">公司名称：</label>			<div class="form-right"><input type="text" name="company" id="company" class="form-control"/><em class="error"></em></div>		</div>		<div class="form-group">			<label for="worlPast" class="control-label">工作岗位：</label>			<div class="form-right"><input type="text" name="worlPast" id="worlPast" class="form-control"/><em class="error"></em></div>		</div>		<div class="form-group">			<label class="control-label">任职时间：</label>			<div class="form-right selectTime">				<span class="starttime"><select class="form-control" id="experStartTimeYear"></select><select class="form-control" id="experStartTimeMonth"></select><select class="hiddenSelect" id="experStartTimeDay"></select></span> —— <span class="endtime"><select class="form-control" id="experEndTimeYear"></select><select class="form-control" id="experEndTimeMonth"></select><select class="hiddenSelect" id="experEndTimeDay"></select></span>				<span class="nowtime">至今</span>				<input type="hidden" name="experStartTime" value="" id="experStartTime"/>				<input type="hidden" name="experEndTime" value="" id="experEndTime"/>				<em class="error"></em>			</div>		</div>		<div class="form-group jobDesc">			<label for="jobDesc" class="control-label">工作描述：</label>			<textarea class="form-control" id="jobDesc" name="jobDesc" placeholder="请输入工作描述"></textarea>			<em class="error"></em>		</div>		<div class="btns">			<span class="keep">保存</span>			<span class="cancel">取消</span>		</div>	</form></div>',r=$(".resume .exper");r.on({click:function(){var e=$(this).parent().parent().parent();$.ajax({type:"POST",url:"/home/s/ajax_del_resume_work/",data:{last_insert_id:e.attr("id")},dataType:"json",success:function(t){t.success?(e.siblings().length||$(".workTab").append("<em>[未完善]</em>"),e.remove()):console.log(t.message)}})}},".del"),r.on({click:function(){var e,t,r,i,n,l,d;t=$(".resume .exper"),e=$(this).parent().parent().parent(),r=e.find(".exper_company").text(),i=e.find(".exper_work_title").text(),n=e.find(".exper_start_time").text()+"-01",l=e.find(".exper_work_content").text(),d="至今"==e.find(".exper_end_time").text()?e.find(".exper_end_time").text():e.find(".exper_end_time").text()+"-01",1==a&&t.children(".create").remove(),1==is_click_experedit&&(e.siblings("li").children(".create").remove(),e.siblings("li").children("div").fadeIn(200)),experliId=e.attr("id"),e.children().fadeOut(1),e.children(".boxTop").before(s),t.find("#company").val(r),t.find("#worlPast").val(i),t.find("#experStartTime").val(n),t.find("#jobDesc").val(l),t.find("#experEndTime").val(d),$("#workLastInsert").val(e.attr("id")),experEndTime=t.find("#experEndTime").val(),experStartTime=t.find("#experStartTime").val(),experSelect(),exper_worktime_endval(),t.find(".add").fadeOut(200),a=!0,is_click_experedit=!0}},".edit"),exper_val_legal(),exper_worktime_endvalnowtime();var a=!1;$(".resume .exper").on({click:function(){var e,t,s,r,a,i,n;return e=$(".resume #company"),t=$(".resume #worlPast"),s=$(".resume #jobDesc"),i=$(".resume #experEndTime"),r=$("#experStartTime").val(),a=$("#experEndTime").val(),"至今"==a&&(a=nowtimes.getFullYear()+"-"+(nowtimes.getMonth()+1)),n=Date.parse(new Date(a))-Date.parse(new Date(r)),0==e.val().length?(e.siblings(".error").text("请输入公司名称"),void 0):e.val().length>50?(e.siblings(".error").text("字数不能超过50个"),void 0):0==t.val().length?(t.siblings(".error").text("请输入工作岗位"),void 0):0>=n?(i.siblings(".error").text("任职时间格式不对，截止时间不能小于等于开始时间"),void 0):0==s.val().length?(s.siblings(".error").text("请输入工作描述"),void 0):s.val().length>500?(s.siblings(".error").text("字数不能超过500个"),void 0):($.ajax({type:"POST",url:"/home/s/ajax_save_resume_work/",data:$("#workExperForm").serialize()+"&resume_work_id="+$("#workLastInsert").attr("value"),dataType:"json",success:function(e){e.success?(save_work_success(e.data.last_insert_id),$(".workTab").find("em").remove()):console.log(e.message)}}),void 0)}},".keep"),$(".resume .exper").on({click:function(){a=!1,$(this).parent().siblings().find(".error").text(""),$(".resume .exper .create").remove(),$(".resume .exper #"+experliId).children(".create").remove(),$(".resume .exper #"+experliId).children().fadeIn(300),$(".resume .exper .add").fadeIn(300)}},".cancel"),$(".resume .exper .add").on("click",function(){$(".resume .exper .add").before(s),$("#workLastInsert").val(""),clearExperVal(),experSelect(),exper_worktime_endval(),0==a&&(a=!0,$(this).fadeOut()),1==is_click_experedit&&(is_click_experedit=!1)});var i='<div class="create"><form id="eudcForm">	<input type="hidden" id="eduLastInsert">	<div class="form-group">		<label for="school" class="control-label">学校名称：</label>		<div class="form-right"><input type="text" name="school" id="school" class="form-control"/><em class="error"></em></div>	</div>	<div class="form-group">		<label for="major" class="control-label">专业名称：</label>		<div class="form-right"><input type="text" name="major" id="major" class="form-control"/><em class="error"></em></div>	</div>	<div class="form-group">		<label class="control-label">就读时间：</label>		<div class="form-right selectTime">			<span class="starttime"><select class="form-control" id="educStartTimeYear"></select><select class="form-control" id="educStartTimeMonth"></select><select class="hiddenSelect" id="educStartTimeDay"></select></span> —— <span class="endtime"><select class="form-control" id="educEndTimeYear"></select><select class="form-control" id="educEndTimeMonth"></select><select class="hiddenSelect" id="educEndTimeDay"></select></span>			<span class="nowtime">至今</span>			<input type="hidden" name="educStartTime" value="" id="educStartTime"/>			<input type="hidden" name="educEndTime" value="" id="educEndTime"/>			<em class="error"></em>		</div>	</div>	<div class="form-group">		<label for="education" class="control-label">学历：</label>		<div class="form-right"><select class="form-control" name="education" id="education">			<option value="硕士">硕士</option>			<option value="本科">本科</option>			<option value="大专">大专</option>			<option value="高中及以下">高中及以下</option>		</select></div>	</div>	<div class="btns">		<span class="keep">保存</span>		<span class="cancel">取消</span>	</div></form></div>',n=$(".resume .educ");n.on({click:function(){var e=$(this).parent().parent().parent();$.ajax({type:"POST",url:"/home/s/ajax_del_resume_edu/",data:{last_insert_id:e.attr("id")},dataType:"json",success:function(t){t.success?(e.siblings().length||$(".eduTab").append("<em>[未完善]</em>"),e.remove()):console.log(t.message)}})}},".del"),n.on({click:function(){var e,t,s,r,a,n,d;t=$(".resume .educ"),e=$(this).parent().parent().parent(),s=e.find(".educ_school").text(),r=e.find(".educ_major").text(),a=e.find(".educ_start_time").text()+"-01",n=e.find(".educ_title").text(),d="至今"==e.find(".educ_end_time").text()?e.find(".educ_end_time").text():e.find(".educ_end_time").text()+"-01",1==l&&t.children(".create").remove(),1==is_click_experedit&&(e.siblings("li").children(".create").remove(),e.siblings("li").children("div").fadeIn(200)),educliId=e.attr("id"),e.children().fadeOut(1),e.children(".boxTop").before(i),t.find("#school").val(s),t.find("#major").val(r),t.find("#educStartTime").val(a),t.find("#education").val(n),t.find("#educEndTime").val(d),$("#eduLastInsert").val(e.attr("id")),educStartTime=t.find("#educStartTime").val(),educEndTime=t.find("#educEndTime").val(),educSelect(),educ_readtime_endval(),t.find(".add").fadeOut(200),l=!0,is_click_educedit=!0}},".edit"),educ_val_legal(),educ_readtime_endvalnowtime();var l=!1;$(".resume .educ").on({click:function(){var e,t,s,r,a,i;return e=$(".resume #school"),t=$(".resume #major"),s=$(".resume #educEndTime"),r=$("#educStartTime").val(),a=$("#educEndTime").val(),"至今"==a&&(a=nowtimes.getFullYear()+"-"+(nowtimes.getMonth()+1)),i=Date.parse(new Date(a))-Date.parse(new Date(r)),0==e.val().length?(e.siblings(".error").text("请输入学校名称"),void 0):0==t.val().length?(t.siblings(".error").text("请输入专业名称"),void 0):0>=i?(s.siblings(".error").text("任职时间格式不对，截止时间不能小于等于开始时间"),void 0):($.ajax({type:"POST",url:"/home/s/ajax_save_resume_edu/",data:$("#eudcForm").serialize()+"&resume_edu_id="+$("#eduLastInsert").attr("value"),dataType:"json",success:function(e){e.success?(save_educ_success(e.data.last_insert_id),$(".eduTab").find("em").remove()):console.log(e.message)}}),void 0)}},".keep"),$(".resume .educ").on({click:function(){l=!1,$(this).parent().siblings().find(".error").text(""),$(".resume .educ .create").remove(),$(".resume .educ #"+educliId).children(".create").remove(),$(".resume .educ #"+educliId).children().fadeIn(300),$(".resume .educ .add").fadeIn(300)}},".cancel"),$(".resume .educ .add").on("click",function(){$(".resume .educ .add").before(i),$("#eduLastInsert").val(""),cleareducVal(),educSelect(),educ_readtime_endval(),0==l&&(l=!0,$(this).fadeOut()),1==is_click_educedit&&(is_click_educedit=!1)})};init();